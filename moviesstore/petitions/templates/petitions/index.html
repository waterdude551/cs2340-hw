{% extends 'base.html' %}

{% block content %}

{% load static %}

<div class="p-3">

  <div class="container">

    <div class="row mt-3">

      <div class="col mx-auto mb-3">

        <h2>List of Petitions</h2>

        <hr />
        <p class="card-text">
          <a href="{% url 'petitions.create_petition_screen' %}" class="btn bg-dark text-white">Create Petition</a>
        </p>

      </div>

    </div>

    <div class="row">

      {% for petition in petitions %}

      <div class="col-md-4 col-lg-3 mb-2">

        <div class="p-2 card align-items-center pt-4">

          <div class="card-body text-center">
            <h5>{{ petition.title }}</h5>
            <p>{{ petition.description }}</p>
            <p>Score: {{ petition.score }}</p>
            {% if user.is_authenticated and petition.voters.all and user in petition.voters.all %}
              <form method="post" action="{% url 'petitions.unvote' petition.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Unvote</button>
              </form>
            {% else %}
              <form method="post" action="{% url 'petitions.vote' petition.id %}">
                {% csrf_token %}
                <button type="submit" class="btn bg-dark text-white">Upvote</button>
              </form>
            {% endif %}
          </div>

        </div>

      </div>

      {% endfor %}

    </div>

  </div>

{% endblock content %}